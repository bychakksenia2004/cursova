{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/magistrature/Dockerwork/kursova/app/editor/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\n\r\nexport default function Editor() {\r\n  // Note: draft auto-save/restore remains in the editor/new page via localStorage.\r\n  const [tests, setTests] = useState<Array<{ _id: string; title: string; description?: string | null }>>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [deletingId, setDeletingId] = useState<string | null>(null);\r\n  const [copiedId, setCopiedId] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    async function load() {\r\n      try {\r\n        const res = await fetch(\"/api/tests\", { credentials: \"include\" });\r\n        if (!res.ok) return;\r\n        const data = await res.json();\r\n        if (mounted && data?.ok && Array.isArray(data.tests)) setTests(data.tests.map((t: any) => ({ _id: t._id || t.id || t._id, title: t.title, description: t.description })));\r\n      } catch (err) {\r\n        console.warn(\"Failed to load tests:\", err);\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    }\r\n    load();\r\n    return () => { mounted = false; };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      document.title = \"TestHub | Редактор тестів\";\r\n    } catch {}\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"container d-flex flex-column align-items-center justify-content-center min-vh-100\">\r\n      <h2 className=\"mb-4 text-center\">Редактор тестів</h2>\r\n      <div className=\"menu-box d-flex flex-column gap-2\">\r\n        <Link href=\"/editor/new\">\r\n          <button className=\"btn btn-primary w-100\">Додати новий тест</button>\r\n        </Link>\r\n        <div className=\"mt-3\">\r\n          <h3 className=\"h6\">Мої тести</h3>\r\n          {loading ? (\r\n            <div className=\"text-muted\">Завантаження...</div>\r\n          ) : tests.length === 0 ? (\r\n            <div className=\"text-muted\">У вас ще немає створених тестів.</div>\r\n          ) : (\r\n            <div className=\"list-group transparent-list\">\r\n              {tests.map((t) => (\r\n                <div key={t._id} className=\"list-group-item d-flex justify-content-between align-items-start\">\r\n                  <div>\r\n                    <div className=\"fw-semibold\">{t.title}</div>\r\n                    {t.description ? <div className=\"text-muted small\">{t.description}</div> : null}\r\n                  </div>\r\n                  <div>\r\n                    <Link href={`/editor/new?edit=${t._id}`}>\r\n                      <button className=\"btn btn-sm btn-outline-primary\">Редагувати</button>\r\n                    </Link>\r\n                    <button\r\n                      className=\"btn btn-sm btn-outline-danger ms-2\"\r\n                      onClick={async () => {\r\n                        try {\r\n                          const ok = confirm(\"Видалити тест? Цю дію не можна відмінити.\");\r\n                          if (!ok) return;\r\n                          setDeletingId(t._id);\r\n                          const res = await fetch(`/api/tests/${t._id}`, { method: \"DELETE\", credentials: \"include\" });\r\n                          if (!res.ok) {\r\n                            const txt = await res.text();\r\n                            throw new Error(txt || `HTTP ${res.status}`);\r\n                          }\r\n                          setTests((s) => s.filter((x) => x._id !== t._id));\r\n                        } catch (err) {\r\n                          console.warn(\"Failed to delete test:\", err);\r\n                          alert(\"Не вдалося видалити тест\");\r\n                        } finally {\r\n                          setDeletingId(null);\r\n                        }\r\n                      }}\r\n                      disabled={deletingId === t._id}\r\n                    >\r\n                      {deletingId === t._id ? \"Видаляю...\" : \"Видалити\"}\r\n                    </button>\r\n                    <button\r\n                      className=\"btn btn-sm btn-outline-success ms-2\"\r\n                      onClick={async () => {\r\n                        try {\r\n                          const origin = typeof window !== \"undefined\" ? window.location.origin : \"\";\r\n                          const url = `${origin}/tests/${t._id}`;\r\n                          if (navigator.clipboard && navigator.clipboard.writeText) {\r\n                            await navigator.clipboard.writeText(url);\r\n                          } else {\r\n                            // fallback\r\n                            const tmp = document.createElement(\"input\");\r\n                            document.body.appendChild(tmp);\r\n                            tmp.value = url;\r\n                            tmp.select();\r\n                            document.execCommand(\"copy\");\r\n                            document.body.removeChild(tmp);\r\n                          }\r\n                          setCopiedId(t._id);\r\n                          setTimeout(() => setCopiedId(null), 2500);\r\n                        } catch (err) {\r\n                          console.warn(\"Failed to copy link:\", err);\r\n                          alert(\"Не вдалося скопіювати посилання\");\r\n                        }\r\n                      }}\r\n                    >\r\n                      {copiedId === t._id ? \"Скопійовано!\" : \"Поділитись\"}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}