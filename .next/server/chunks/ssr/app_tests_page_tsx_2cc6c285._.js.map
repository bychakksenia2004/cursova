{"version":3,"sources":["../../../../app/tests/page.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport Link from \"next/link\";\r\n\r\nexport default function PublicTestsPage() {\r\n  const [tests, setTests] = useState<Array<{ _id: string; title: string; description?: string | null; author?: string | null; storeResponses?: boolean }>>([]);\r\n  const [query, setQuery] = useState<string>(\"\");\r\n  const [authorQuery, setAuthorQuery] = useState<string>(\"\");\r\n  const [loading, setLoading] = useState(true);\r\n  const [page, setPage] = useState<number>(1);\r\n  const [totalPages, setTotalPages] = useState<number>(1);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    async function load() {\r\n      try {\r\n        const res = await fetch(`/api/public-tests?page=${page}&limit=10`, { cache: \"no-store\" });\r\n        if (!res.ok) {\r\n          console.warn(\"Failed to load public tests\", await res.text());\r\n          return;\r\n        }\r\n        const data = await res.json();\r\n        if (mounted && data?.ok && Array.isArray(data.tests)) {\r\n          setTests(data.tests);\r\n          setTotalPages(data.totalPages || 1);\r\n        }\r\n      } catch (err) {\r\n        console.warn(\"Failed to load public tests:\", err);\r\n      } finally {\r\n        if (mounted) setLoading(false);\r\n      }\r\n    }\r\n    load();\r\n    return () => { mounted = false; };\r\n  }, [page]);\r\n\r\n  useEffect(() => {\r\n    try { document.title = \"TestHub | Публічні тести\"; } catch {}\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"container d-flex flex-column align-items-center justify-content-center min-vh-100\">\r\n      <h2 className=\"mb-4 text-center\">Публічні тести</h2>\r\n      <div className=\"menu-box d-flex flex-column gap-2\">\r\n        <div>\r\n          <input className=\"form-control mb-2\" placeholder=\"Пошук за назвою тесту...\" value={query} onChange={(e) => { setQuery(e.target.value); setPage(1); }} />\r\n          <input className=\"form-control\" placeholder=\"Пошук за автором...\" value={authorQuery} onChange={(e) => { setAuthorQuery(e.target.value); setPage(1); }} />\r\n        </div>\r\n        {loading ? (\r\n          <div className=\"text-muted\">Завантаження...</div>\r\n          ) : tests.length === 0 ? (\r\n          <div className=\"text-muted\">Публічних тестів не знайдено.</div>\r\n          ) : (\r\n          <div className=\"list-group transparent-list\">\r\n              {tests.filter((t) => t.title.toLowerCase().includes(query.toLowerCase()) && (authorQuery ? (t.author || \"\").toLowerCase().includes(authorQuery.toLowerCase()) : true)).map((t) => (\r\n              <div key={t._id} className=\"list-group-item d-flex justify-content-between align-items-start\">\r\n                <div>\r\n                  <div className=\"fw-semibold\">{t.title}</div>\r\n                  {t.description ? <div className=\"text-muted small\">{t.description}</div> : null}\r\n                  <div className=\"text-muted small mt-1\">Автор: {t.author || \"(невідомо)\"}</div>\r\n                  {t.storeResponses ? <div className=\"mt-1\"><span className=\"badge bg-warning text-dark\">Потрібна реєстрація</span></div> : null}\r\n                </div>\r\n                <div>\r\n                  <Link href={`/tests/${t._id}`}>\r\n                    <button className=\"btn btn-sm btn-outline-primary\">Відкрити</button>\r\n                  </Link>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n        <div className=\"d-flex justify-content-between align-items-center mt-3\">\r\n          <button className=\"btn btn-outline-secondary\" disabled={page <= 1} onClick={() => setPage((p) => Math.max(1, p - 1))}>Назад</button>\r\n          <div>Сторінка {page} / {totalPages}</div>\r\n          <button className=\"btn btn-outline-secondary\" disabled={page >= totalPages} onClick={() => setPage((p) => Math.min(totalPages, p + 1))}>Далі</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}